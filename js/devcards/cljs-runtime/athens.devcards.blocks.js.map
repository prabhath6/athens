{"version":3,"sources":["athens/devcards/blocks.cljs"],"mappings":"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","names":["athens.devcards.blocks/block-style","athens.devcards.blocks/block-disclosure-toggle-style","athens.style.color.cljs$core$IFn$_invoke$arity$1","athens.devcards.blocks/block-indicator-style","G__58689","garden.selectors/&","garden.selectors/after","athens.style/OPACITIES","G__58690","garden.selectors/before","G__58691","stylefy.core.keyframes.cljs$core$IFn$_invoke$arity$variadic","athens.devcards.blocks/drop-area-indicator","athens.devcards.blocks/block-content-style","athens.devcards.blocks/tooltip-style","athens.style/DEPTH-SHADOWS","athens.style.color.cljs$core$IFn$_invoke$arity$2","athens.devcards.blocks/block-component","ident","block","posh.reagent/pull","athens.db/dsdb","athens.db/block-pull-pattern","cljs.core/deref","athens.db/sort-block","athens.devcards.blocks/block-el","p__58692","map__58693","cljs.core/PROTOCOL_SENTINEL","cljs.core.apply.cljs$core$IFn$_invoke$arity$2","cljs.core/hash-map","cljs.core.get.cljs$core$IFn$_invoke$arity$2","uid","string","open","order","children","dbid","map__58695","open?","and__4174__auto__","cljs.core/seq","closed?","cljs.core/not","editing-uid","G__58696","re-frame.core/subscribe","tooltip-uid","G__58697","x","y","dragging-uid","closest-uid","closest-kind","G__58698","stylefy.core.use_style.cljs$core$IFn$_invoke$arity$2","cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic","cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2","athens.devcards.blocks/dragging-style","clojure.string.join.cljs$core$IFn$_invoke$arity$2","G__58700","G__58701","athens.devcards.blocks/toggle","js/module$node_modules$$material_ui$icons$index.KeyboardArrowDown","stylefy.core.use_style.cljs$core$IFn$_invoke$arity$1","athens.router.navigate_uid.cljs$core$IFn$_invoke$arity$1","komponentit.autosize/textarea","e","G__58702","G__58703","athens.devcards.blocks/db-on-change","athens.devcards.blocks/on-key-down","athens.parse-renderer/parse-and-render","iter__4582__auto__","s__58705","cljs.core/LazySeq","temp__5735__auto__","cljs.core/chunked-seq?","c__4580__auto__","size__4581__auto__","cljs.core/count","b__58707","cljs.core/chunk-buffer","i__58706","cljs.core._nth.cljs$core$IFn$_invoke$arity$2","cljs.core/chunk-append","cljs.core/chunk-cons","cljs.core/chunk","iter__58704","cljs.core/chunk-rest","cljs.core/first","cljs.core/cons","cljs.core/rest","child","athens.devcards.blocks/on-change","val","G__58708","re-frame.core/dispatch","goog.functions/debounce","id","G__58709","key","shift","sel-start","goog.events.KeyCodes/TAB","G__58710","G__58711","goog.events.KeyCodes/ENTER","G__58712","goog.events.KeyCodes/BACKSPACE","G__58713","devcards.core/register-card","devcards.core/card-base","js/athens","js/athens.devcards","js/athens.devcards.blocks","js/athens.devcards.blocks.t_athens$devcards$blocks58714","athens.devcards.blocks/t_athens$devcards$blocks58714","_58716","meta58715","this__42498__auto__","devcard-opts__42499__auto__","cljs.core.assoc.cljs$core$IFn$_invoke$arity$variadic","v__42517__auto__","cljs.core/fn?","data-atom__42518__auto__","owner__42519__auto__","reagent.core/as-element","devcards.core/assert-options-map","this__4428__auto__","writer__4429__auto__","opt__4430__auto__","cljs.core/-write","athens.devcards.blocks/->t_athens$devcards$blocks58714","cljs.core/chunk-first"],"sourcesContent":["(ns athens.devcards.blocks\r\n  (:require\r\n    [\"@material-ui/icons\" :as mui-icons]\r\n    [athens.db :as db]\r\n    [athens.parse-renderer :refer [parse-and-render]]\r\n    [athens.router :refer [navigate-uid]]\r\n    [athens.style :refer [color DEPTH-SHADOWS OPACITIES]]\r\n    [cljsjs.react]\r\n    [cljsjs.react.dom]\r\n    [clojure.string :refer [join]]\r\n    [devcards.core :refer-macros [defcard-rg]]\r\n    [garden.selectors :as selectors]\r\n    [goog.functions :refer [debounce]]\r\n    [komponentit.autosize :as autosize]\r\n    [posh.reagent :refer [pull]]\r\n    [re-frame.core  :refer [dispatch subscribe]]\r\n    [stylefy.core :as stylefy :refer [use-style]])\r\n  (:import\r\n    (goog.events\r\n      KeyCodes)))\r\n\r\n\r\n;;; Styles\r\n\r\n\r\n(def block-style\r\n  {:display \"flex\"\r\n   :line-height \"2em\"\r\n   :position \"relative\"\r\n   :justify-content \"flex-start\"\r\n   :flex-direction \"column\"})\r\n\r\n\r\n(def block-disclosure-toggle-style\r\n  {:width \"1em\"\r\n   :height \"2em\"\r\n   :flex-shrink \"0\"\r\n   :display \"flex\"\r\n   :background \"none\"\r\n   :border \"none\"\r\n   :border-radius \"100px\"\r\n   :transition \"all 0.05s ease\"\r\n   :align-items \"center\"\r\n   :justify-content \"center\"\r\n   :padding \"0\"\r\n   :-webkit-appearance \"none\"\r\n   ::stylefy/mode [[:hover {:color (color :link-color)}]\r\n                   [\":is(button)\" {:cursor \"pointer\"}]]\r\n   ::stylefy/manual [[:&.closed [:svg {:transform \"rotate(-90deg)\"}]]]})\r\n\r\n\r\n(def block-indicator-style\r\n  {:flex-shrink \"0\"\r\n   :cursor \"pointer\"\r\n   :width \"0.75em\"\r\n   :margin-right \"0.25em\"\r\n   :transition \"all 0.05s ease\"\r\n   :height \"2em\"\r\n   :color (color :panel-color)\r\n   ::stylefy/mode [[:after {:content \"''\"\r\n                            :background \"currentColor\"\r\n                            :transition \"all 0.05s ease\"\r\n                            :border-radius \"100px\"\r\n                            :box-shadow \"0 0 0 2px transparent\"\r\n                            :display \"inline-flex\"\r\n                            :margin \"50% 0 0 50%\"\r\n                            :transform \"translate(-50%, -50%)\"\r\n                            :height \"0.3125em\"\r\n                            :width \"0.3125em\"}]\r\n                   [:hover {:color (color :link-color)}]]\r\n\r\n   ::stylefy/manual [[:&.open {}]\r\n                     [:&.closed {}]\r\n                     [:&.closed [(selectors/& (selectors/after)) {:box-shadow (str \"0 0 0 2px \" (color :body-text-color))\r\n                                                                  :opacity (:opacity-med OPACITIES)}]]\r\n                     [:&.closed [(selectors/& (selectors/before)) {:content \"none\"}]]\r\n                     [:&.closed [(selectors/& (selectors/before)) {:content \"none\"}]]\r\n                     [:&:hover:after {:transform \"translate(-50%, -50%) scale(1.3)\"}]\r\n                     [:&.dragging {:z-index \"1000\"\r\n                                   :cursor \"grabbing\"\r\n                                   :color (color :body-text-color)}]\r\n                     [:&.selected {}]]})\r\n\r\n\r\n(stylefy/keyframes \"drop-area-appear\"\r\n                   [:from\r\n                    {:opacity \"0\"}]\r\n                   [:to\r\n                    {:opacity \"1\"}])\r\n\r\n\r\n(stylefy/keyframes \"drop-area-color-pulse\"\r\n                   [:from\r\n                    {:opacity (:opacity-lower OPACITIES)}]\r\n                   [:to\r\n                    {:opacity (:opacity-med OPACITIES)}])\r\n\r\n\r\n(def drop-area-indicator\r\n  {:display \"block\"\r\n   :height \"1px\"\r\n   :margin-bottom \"-1px\"\r\n   :color (color :body-text-color)\r\n   :position \"relative\"\r\n   :transform-origin \"left\"\r\n   :z-index \"1000\"\r\n   :width \"100%\"\r\n   :animation \"drop-area-appear .5s ease\"\r\n   ::stylefy/manual [[:&:after {:position \"absolute\"\r\n                                :content \"''\"\r\n                                :top \"-0.5px\"\r\n                                :right \"0\"\r\n                                :bottom \"-0.5px\"\r\n                                :left \"0\"\r\n                                :border-radius \"100px\"\r\n                                :animation \"drop-area-color-pulse 1s ease infinite alternate\"\r\n                                :background \"currentColor\"}]]})\r\n\r\n\r\n(def block-content-style\r\n  {:position \"relative\"\r\n   :overflow \"visible\"\r\n   :z-index \"1\"\r\n   :flex-grow \"1\"\r\n   :word-break \"break-word\"\r\n   ::stylefy/manual [[:textarea {:display \"none\"}]\r\n                     [:&:hover [:textarea {:display \"block\"\r\n                                           :z-index 1}]]\r\n                     [:textarea {:-webkit-appearance \"none\"\r\n                                 :cursor \"text\"\r\n                                 :resize \"none\"\r\n                                 :transform \"translate3d(0,0,0)\"\r\n                                 :color \"inherit\"\r\n                                 :padding \"0\"\r\n                                 :background (color :panel-color)\r\n                                 :position \"absolute\"\r\n                                 :top \"0\"\r\n                                 :left \"0\"\r\n                                 :right \"0\"\r\n                                 :width \"100%\"\r\n                                 :min-height \"100%\"\r\n                                 :caret-color (color :link-color)\r\n                                 :margin \"0\"\r\n                                 :font-size \"inherit\"\r\n                                 :line-height \"inherit\"\r\n                                 :border-radius \"4px\"\r\n                                 :transition \"opacity 0.15s ease\"\r\n                                 :box-shadow (str \"-4px 0 0 0\" (color :panel-color))\r\n                                 :border \"0\"\r\n                                 :opacity \"0\"\r\n                                 :font-family \"inherit\"}]\r\n                     [:textarea:focus\r\n                      :.is-editing {:outline \"none\"\r\n                                    :z-index \"10\"\r\n                                    :display \"block\"\r\n                                    :opacity \"1\"}]\r\n                     [:span [:span\r\n                             :a {:position \"relative\"\r\n                                 :z-index \"2\"}]]]})\r\n\r\n\r\n(stylefy/keyframes \"tooltip-appear\"\r\n                   [:from\r\n                    {:opacity \"0\"\r\n                     :transform \"scale(0)\"}]\r\n                   [:to\r\n                    {:opacity \"1\"\r\n                     :transform \"scale(1)\"}])\r\n\r\n\r\n(def tooltip-style\r\n  {:z-index    2\r\n   :position \"absolute\"\r\n   :box-shadow [[(:64 DEPTH-SHADOWS) \", 0 0 0 1px \" (color :body-text-color :opacity-lower)]]\r\n   :flex-direction \"column\"\r\n   :background-color \"white\"\r\n   :padding \"8px 12px\"\r\n   :border-radius \"4px\"\r\n   :line-height \"24px\"\r\n   :left \"8px\"\r\n   :top \"32px\"\r\n   :transform-origin \"8px 24px\"\r\n   :min-width \"150px\"\r\n   :animation \"tooltip-appear .2s ease\"\r\n   :transition \"background .1s ease\"\r\n   :display \"table\"\r\n   :color (color :body-text-color :opacity-high)\r\n   :border-spacing \"4px\"\r\n   ::stylefy/manual [[:div {:display \"table-row\"}]\r\n                     [:b {:display \"table-cell\"\r\n                          :user-select \"none\"\r\n                          :text-align \"right\"\r\n                          :text-transform \"uppercase\"\r\n                          :font-size \"12px\"\r\n                          :letter-spacing \"0.1em\"\r\n                          :opacity (:opacity-med OPACITIES)}]\r\n                     [:span {:display \"table-cell\"\r\n                             :user-select \"all\"}\r\n                      [:&:hover {:color (color :header-text-color)}]]\r\n                     [:&:after {:content \"''\"\r\n                                :position \"absolute\"\r\n                                :top \"-12px\"\r\n                                :bottom \"-16px\"\r\n                                :border-radius \"inherit\"\r\n                                :left \"-16px\"\r\n                                :right \"-16px\"\r\n                                :z-index -1\r\n                                :display \"block\"}]]})\r\n\r\n\r\n(def dragging-style)\r\n  ;;{:background-color \"lightblue\"})\r\n\r\n\r\n\r\n;;; Components\r\n\r\n\r\n(declare block-component block-el toggle on-key-down db-on-change)\r\n\r\n\r\n(defn block-component\r\n  \"This query is long because I'm not sure how to recursively find all child blocks with all attributes\r\n  '[* {:block/children [*]}] doesn't work\r\nAlso, why does datascript return a reaction of {:db/id nil} when pulling for [:block/uid uid]?\r\nno results for q returns nil\r\nno results for pull eid returns nil\r\n  \"\r\n  [ident]\r\n  (let [block (->> @(pull db/dsdb db/block-pull-pattern ident)\r\n                   (db/sort-block))]\r\n    [block-el block]))\r\n\r\n\r\n;; TODO: more clarity on open? and closed? predicates, why we use `cond` in one case and `if` in another case\r\n(defn block-el\r\n  \"Two checks to make sure block is open or not: children exist and :block/open bool\"\r\n  [{:block/keys [uid string open order children] dbid :db/id}]\r\n  (let [open?       (and (seq children) open)\r\n        closed?     (and (seq children) (not open))\r\n        editing-uid @(subscribe [:editing-uid])\r\n        tooltip-uid @(subscribe [:tooltip-uid])\r\n        {:keys        [x y]\r\n         dragging-uid :uid\r\n         closest-uid  :closest/uid\r\n         closest-kind :closest/kind} @(subscribe [:drag-bullet])]\r\n\r\n    [:div (use-style (merge block-style\r\n                            (when (= dragging-uid uid) dragging-style))\r\n                     {:class    (join \" \" [\"block-container\" (when (= dragging-uid uid) \"dragging\")])\r\n                      :data-uid uid})\r\n     [:div {:style {:display \"flex\"}}\r\n\r\n      ;; Toggle\r\n      (if (seq children)\r\n        [:button (use-style block-disclosure-toggle-style\r\n                            {:class (cond open? \"open\" closed? \"closed\")\r\n                             :on-click #(toggle [:block/uid uid] open)})\r\n         [:> mui-icons/KeyboardArrowDown {:style {:font-size \"16px\"}}]]\r\n        [:span (use-style block-disclosure-toggle-style)])\r\n\r\n      ;; Bullet\r\n      (if (= dragging-uid uid)\r\n        [:span (merge (use-style block-indicator-style\r\n                                 {:class    (join \" \" [\"bullet\" \"dragging\" (if closed? \"closed\" \"open\")])\r\n                                  :data-uid uid})\r\n                      {:style {:transform (str \"translate(\" x \"px, \" y \"px)\")}})]\r\n\r\n        [:span (use-style block-indicator-style\r\n                          {:class    (str \"bullet \" (if closed? \"closed\" \"open\"))\r\n                           :data-uid uid\r\n                           :on-click #(navigate-uid uid)})])\r\n\r\n      ;; Tooltip\r\n      (when (and (= tooltip-uid uid)\r\n                 (not dragging-uid))\r\n        [:div (use-style tooltip-style {:class \"tooltip\"})\r\n         [:div [:b \"db/id\"] [:span dbid]]\r\n         [:div [:b \"uid\"] [:span uid]]\r\n         [:div [:b \"order\"] [:span order]]])\r\n\r\n      ;; Actual Contents\r\n      [:div (use-style (merge block-content-style {:user-select (when dragging-uid \"none\")})\r\n                       {:class    \"block-contents\"\r\n                        :data-uid uid})\r\n       [autosize/textarea {:default-value       string\r\n                           :class       (when (= editing-uid uid) \"is-editing\")\r\n                           :auto-focus  true\r\n                           :on-change   (fn [e] (db-on-change (.. e -target -value) uid))\r\n                           :on-key-down (fn [e] (on-key-down e uid))}]\r\n       [parse-and-render string]\r\n\r\n       ;; Drop Indicator\r\n       (when (and (= closest-uid uid)\r\n                  (= closest-kind :child))\r\n         [:span (use-style drop-area-indicator)])]]\r\n\r\n     ;; Children\r\n     (when open?\r\n       (for [child children]\r\n         [:div {:style {:margin-left \"32px\"} :key (:db/id child)}\r\n          [block-el child]]))\r\n\r\n     ;; Drop Indicator\r\n     (when (and (= closest-uid uid) (= closest-kind :sibling))\r\n       [:span (use-style drop-area-indicator)])]))\r\n\r\n;; Helpers\r\n\r\n(defn on-change\r\n  [val uid]\r\n  (dispatch [:transact-event [[:db/add uid :block/string val]]]))\r\n\r\n\r\n(def db-on-change (debounce on-change 500))\r\n\r\n\r\n(defn toggle\r\n  [id open]\r\n  (dispatch [:transact-event [[:db/add id :block/open (not open)]]]))\r\n\r\n\r\n(defn on-key-down\r\n  [e uid]\r\n  (let [key       (.. e -keyCode)\r\n        shift     (.. e -shiftKey)\r\n        val       (.. e -target -value)\r\n        sel-start (.. e -target -selectionStart)]\r\n    (cond\r\n      (and (= key KeyCodes.TAB) shift) (dispatch [:unindent uid])\r\n      (= key KeyCodes.TAB) (dispatch [:indent uid])\r\n      (= key KeyCodes.ENTER) (dispatch [:enter uid val sel-start])\r\n      (and (= key KeyCodes.BACKSPACE) (zero? sel-start)) (dispatch [:backspace uid]))))\r\n\r\n\r\n;;; Devcards\r\n\r\n\r\n(defcard-rg Block\r\n  \"Pull entity 2347, a block within Athens FAQ, and its children. Doesn't pull parents, unlike `block-page`\"\r\n  [block-component 2347])\r\n"]}