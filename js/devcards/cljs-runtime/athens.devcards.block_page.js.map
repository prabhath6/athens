{"version":3,"sources":["athens/devcards/block_page.cljs"],"mappings":"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","names":["athens.devcards.block-page/title-style","athens.style.color.cljs$core$IFn$_invoke$arity$1","garden.selectors/+","p__58893","map__58895","cljs.core/PROTOCOL_SENTINEL","cljs.core.apply.cljs$core$IFn$_invoke$arity$2","cljs.core/hash-map","cljs.core.get.cljs$core$IFn$_invoke$arity$2","athens.devcards.block-page/block-page-el","string","children","uid","parents","editing-uid","iter__4582__auto__","s__58905","cljs.core/LazySeq","temp__5735__auto__","cljs.core/seq","cljs.core/chunked-seq?","c__4580__auto__","size__4581__auto__","cljs.core/count","b__58907","cljs.core/chunk-buffer","i__58906","map__58914","cljs.core._nth.cljs$core$IFn$_invoke$arity$2","cljs.core/chunk-append","cljs.core/chunk-cons","cljs.core/chunk","iter__58904","cljs.core/chunk-rest","map__58917","cljs.core/first","cljs.core/cons","cljs.core/rest","title","athens.router.navigate_uid.cljs$core$IFn$_invoke$arity$1","or__4185__auto__","cljs.core.interpose.cljs$core$IFn$_invoke$arity$2","cljs.core.map.cljs$core$IFn$_invoke$arity$2","x","cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2","reagent.core/adapt-react-class","js/module$node_modules$$material_ui$icons$index.KeyboardArrowRight","stylefy.core.use_style.cljs$core$IFn$_invoke$arity$1","stylefy.core.use_style.cljs$core$IFn$_invoke$arity$2","komponentit.autosize/textarea","e","G__58926","G__58927","athens.devcards.blocks/db-on-change","s__58929","b__58931","i__58930","iter__58928","child","map__58935","map__58937","id","athens.devcards.blocks/block-el","athens.devcards.block-page/block-page-component","ident","cljs.core/deref","block","posh.reagent/pull","athens.db/dsdb","athens.db/block-pull-pattern","athens.db/parents-pull-pattern","athens.db/shape-parent-query","G__58942","re-frame.core/subscribe","devcards.core/register-card","devcards.core/card-base","js/athens","js/athens.devcards","js/athens.devcards.block-page","js/athens.devcards.block-page.t_athens$devcards$block_page58946","athens.devcards.block-page/t_athens$devcards$block_page58946","_58948","meta58947","this__42498__auto__","devcard-opts__42499__auto__","cljs.core.assoc.cljs$core$IFn$_invoke$arity$variadic","v__42517__auto__","cljs.core/fn?","data-atom__42518__auto__","owner__42519__auto__","reagent.core/as-element","cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic","devcards.core/assert-options-map","this__4428__auto__","writer__4429__auto__","opt__4430__auto__","cljs.core/-write","athens.devcards.block-page/->t_athens$devcards$block_page58946","cljs.core/chunk-first"],"sourcesContent":["(ns athens.devcards.block-page\n  (:require\n    [\"@material-ui/icons\" :as mui-icons]\n    [athens.db :as db]\n    [athens.devcards.blocks :refer [block-el db-on-change]]\n    [athens.router :refer [navigate-uid]]\n    [athens.style :refer [color]]\n    [cljsjs.react]\n    [cljsjs.react.dom]\n    [devcards.core :refer-macros [defcard-rg]]\n    [garden.selectors :as selectors]\n    [komponentit.autosize :as autosize]\n    [posh.reagent :refer [pull]]\n    [re-frame.core :refer [subscribe]]\n    [reagent.core :as r]\n    [stylefy.core :as stylefy :refer [use-style]]))\n\n\n;;; Styles\n\n(def title-style\n  {:position \"relative\"\n   :overflow \"visible\"\n   :flex-grow \"1\"\n   :margin \"0.2em 0\"\n   :letter-spacing \"-0.03em\"\n   :word-break \"break-word\"\n   ::stylefy/manual [[:textarea {:display \"none\"}]\n                     [:&:hover [:textarea {:display \"block\"\n                                           :z-index 1}]]\n                     [:textarea {:-webkit-appearance \"none\"\n                                 :cursor \"text\"\n                                 :resize \"none\"\n                                 :transform \"translate3d(0,0,0)\"\n                                 :color \"inherit\"\n                                 :font-weight \"inherit\"\n                                 :padding \"0\"\n                                 :letter-spacing \"inherit\"\n                                 :position \"absolute\"\n                                 :top \"0\"\n                                 :left \"0\"\n                                 :right \"0\"\n                                 :width \"100%\"\n                                 :min-height \"100%\"\n                                 :caret-color (color :link-color)\n                                 :background \"transparent\"\n                                 :margin \"0\"\n                                 :font-size \"inherit\"\n                                 :line-height \"inherit\"\n                                 :border-radius \"4px\"\n                                 :transition \"opacity 0.15s ease\"\n                                 :border \"0\"\n                                 :opacity \"0\"\n                                 :font-family \"inherit\"}]\n                     [:textarea:focus\n                      :.is-editing {:outline \"none\"\n                                    :z-index \"10\"\n                                    :display \"block\"\n                                    :opacity \"1\"}]\n                     [(selectors/+ :.is-editing :span) {:opacity 0}]]})\n\n\n;;; Components\n\n\n(defn block-page-el\n  [{:block/keys [string children uid]} parents editing-uid]\n\n  [:div\n   ;; Parent Context\n   [:span {:style {:color \"gray\"}}\n\n    (->> (for [{:keys [node/title block/uid block/string]} parents]\n           [:span {:key uid :style {:cursor \"pointer\"} :on-click #(navigate-uid uid)} (or string title)])\n         (interpose \">\")\n         (map (fn [x]\n                (if (= x \">\")\n                  [(r/adapt-react-class mui-icons/KeyboardArrowRight) (use-style {:vertical-align \"middle\"})]\n                  x))))]\n\n\n;; Header\n   [:h1 (use-style title-style {:data-uid uid :class \"block-header\"})\n    [autosize/textarea\n     {:default-value string\n      :class (when (= editing-uid uid) \"is-editing\")\n      :auto-focus true\n      :on-change  (fn [e] (db-on-change (.. e -target -value) uid))}]\n    [:span string]]\n\n\n   ;; Children\n   [:div (for [child children]\n           (let [{:keys [db/id]} child]\n             ^{:key id} [block-el child]))]])\n\n\n(defn block-page-component\n  [ident]\n  (let [block   @(pull db/dsdb db/block-pull-pattern ident)\n        parents (->> @(pull db/dsdb db/parents-pull-pattern ident)\n                     (db/shape-parent-query))\n        editing-uid @(subscribe [:editing-uid])]\n    [block-page-el block parents editing-uid]))\n\n\n;;; Devcards\n\n\n(defcard-rg Block-Page\n  \"pull entity 2347: a block within Athens FAQ\"\n  [block-page-component 2347])\n"]}