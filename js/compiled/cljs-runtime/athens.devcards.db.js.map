{"version":3,"sources":["athens/devcards/db.cljs"],"mappings":"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","names":["athens.devcards.db/load-real-db!","conn","c__41735__auto__","cljs.core.async.chan.cljs$core$IFn$_invoke$arity$1","cljs.core.async.impl.dispatch/run","f__41736__auto__","switch__41712__auto__","state_52162","state_val_52163","statearr-52164","inst_52125","inst_52126","inst_52127","cljs.core/PersistentHashMap","inst_52128","cljs.core.async.impl.ioc-helpers/take!","statearr-52165","inst_52158","statearr-52166","statearr-52167","inst_52130","inst_52135","inst_52136","inst_52137","inst_52138","cljs.core/PROTOCOL_SENTINEL","inst_52139","statearr-52168","statearr-52169","inst_52153","inst_52155","inst_52156","statearr-52170","inst_52132","inst_52133","cljs.core/not","statearr-52171","statearr-52172","statearr-52173","inst_52151","inst_52152","cljs.core.get.cljs$core$IFn$_invoke$arity$2","statearr-52174","statearr-52175","statearr-52176","inst_52148","cljs.core.apply.cljs$core$IFn$_invoke$arity$2","cljs.core/hash-map","statearr-52177","inst_52146","statearr-52178","statearr-52179","inst_52160","cljs.core.async.impl.ioc-helpers/return-chan","statearr-52180","inst_52143","statearr-52181","statearr-52182","state-machine__41713__auto__","ret-value__41714__auto__","result__41715__auto__","cljs.core/keyword-identical?","e52183","js/Object","ex__41716__auto__","statearr-52184","cljs.core.async.impl.ioc-helpers/process-exception","state__41737__auto__","statearr-52185","cljs.core.async.impl.ioc-helpers/USER-START-IDX","cljs.core.async.impl.ioc-helpers/run-state-machine-wrapped","cljs_http.client.get.cljs$core$IFn$_invoke$arity$variadic","athens.db/athens-url","posh.reagent/transact!","athens.db/str-to-db-tx","js/alert","athens.devcards.db/load-real-db-button","pressed?","reagent.core.atom.cljs$core$IFn$_invoke$arity$1","handler","cljs.core.swap_BANG_.cljs$core$IFn$_invoke$arity$2","cljs.core/deref","athens.devcards.buttons/button-primary","athens.devcards.db/new-conn","datascript.core.create_conn.cljs$core$IFn$_invoke$arity$1","athens.db/schema","athens.devcards.db/posh-conn!","posh.reagent/posh!"],"sourcesContent":["(ns athens.devcards.db\n  (:require\n    [athens.db :as db]\n    [athens.devcards.buttons :refer [button-primary]]\n    [cljs-http.client :as http]\n    [cljs.core.async :refer [go <!]]\n    [cljsjs.react]\n    [cljsjs.react.dom]\n    [datascript.core :as d]\n    [devcards.core :refer [defcard defcard-rg]]\n    [posh.reagent :refer [posh! transact!]]\n    [reagent.core :as r]))\n\n\n(defn load-real-db!\n  [conn]\n  (go\n    (let [res (<! (http/get db/athens-url {:with-credentials? false}))\n          {:keys [success body]} res]\n      (if success\n        (transact! conn (db/str-to-db-tx body))\n        (js/alert \"Failed to retrieve data from GitHub\")))))\n\n\n(defn load-real-db-button\n  [conn]\n  (let [pressed? (r/atom false)\n        handler (fn []\n                  (swap! pressed? not)\n                  (load-real-db! conn))]\n    (fn []\n      [button-primary {:disabled @pressed?\n                       :on-click-fn handler\n                       :label \"Load Real Data\"}])))\n\n\n(defcard-rg Load-Real-DB\n  \"Downloads the ego db. Takes a few seconds.\"\n  [load-real-db-button db/dsdb])\n\n\n(defcard athens-dsdb\n  \"The main Athens dsdb:\"\n  db/dsdb)\n\n\n(defn new-conn\n  []\n  (d/create-conn db/schema))\n\n\n(defn posh-conn!\n  [conn]\n  (posh! conn))\n\n"]}